# 📌 TIL - 2025-03-20

## 🐟 CNN 기반 어류 분류 모델 학습 (ResNet50 + CutMix + AugMix)

### 1. 데이터 증강 및 Combined Generator 개선
- `CutMixGenerator`를 활용하여 CutMix 기법을 적용
- `CombinedGenerator`에서 데이터셋을 **4등분(one_four = total_steps // 4)** 하는 방식 대신 **각 증강 기법의 비율을 자동으로 조절하는 방식**으로 수정
  - `len(generator)`를 활용하여 데이터 개수를 기반으로 비율을 계산
  - `self.total_steps`를 동적으로 나누어 각 증강 기법이 균형을 이루도록 개선

### 2. AugMix와 CutMix의 결합 문제
- AugMix 데이터를 CutMix하는 것은 논리적으로 가능하지만, **순서와 데이터 흐름을 명확하게 정의해야 함**
- 현재 `augmix_generator = CutMixGenerator(base_generator=augmentation_generator, alpha=0.8)` 방식에서는 실제로 AugMix가 적용된 데이터인지 확인 필요
- **해결책**: `AugMixCutMixGenerator`를 별도로 만들어 AugMix 후 CutMix를 적용하도록 수정

### 3. 학습 성능 분석
- 초기 학습률 `3e-4`로 시작하여, 20 Epoch 이후 `9e-5`, `6e-5`로 감소
- 학습 진행:
  - `accuracy`: 10.2% → 83.2%
  - `val_accuracy`: 39% → 94~95%
  - `loss`: 3.15 → 1.02 (안정적인 감소)
- 검증 정확도가 높으므로 오버피팅 위험은 낮지만, `train_accuracy` 대비 `val_accuracy`가 높은 점을 고려해야 함.

### 4. 추가 개선 방향
- **테스트 데이터셋에서 평가 수행** (test_accuracy 확인)
- **Confusion Matrix 분석**하여 특정 클래스에서 오분류가 발생하는지 확인
- **EarlyStopping**을 활성화하여 적절한 시점에 학습 종료 가능
- **Dropout 조정** 여부 확인하여 일반화 성능 최적화 가능

💡 **결론**: 모델 학습에서 **데이터 증강 기법 조합**과 **학습률 조정**이 중요한 역할을 하며, 모델의 일반화 성능을 향상시키기 위해서는 데이터 분포와 학습 과정의 균형을 유지해야 한다

